<!------------------------->
<!--- Datos geográficos --->
<!------------------------->
## **[1.] Datos geográficos**

<!---------------->
#### **1.1. ¿Qué es GIS?**

Un **Sistema de Información Geográfico** (GIS por sus siglas en inglés), es un sistema (software + hardware) que permite gestionar y analizar la información capturada en el entorno físico.

![](pics/gis_intro.png){width=600}

Ver código de R [aquí]()

<!---------------->
#### **1.2. Modelos de datos geográficos**

##### **1.2.1. Datos vectoriales:**

La geometría de este tipo de datos se compone de uno o más vértices interconectados. Un vértice describe una posición en el espacio utilizando un eje X y un eje Y (opcionalmente también un eje z). Mas información [aquí](https://docs.qgis.org/2.14/es/docs/gentle_gis_introduction/vector_data.html).

##### **1.2.2. Datos raster:**

Un conjunto de datos ráster está compuesto por una matriz de píxeles (también conocidos como celdas). Cada píxel representa una región geográfica, y el valor del píxel representa alguna característica de la región. Mas información [aquí](https://docs.qgis.org/2.14/es/docs/gentle_gis_introduction/raster_data.html).

<!---------------->
#### **1.3. Geometrías para datos vectoriales**

![](pics/geometry.png){width=600}

Tomado de: [Applied Spatial Data Analysis with R](https://www.springer.com/gp/book/9781461476177)   
**Punto:** está compuesto de un solo vértice.
**Línea o arco:** está compuesto de dos o más vértices, pero el primer y el último vértice deben ser diferentes. **Polígono:** está compuesto de tres o más vértices, pero el último vértice es igual a la primero.

<!---------------->
#### **1.4. Extensiones de los archivos**

```{r,echo=F}
my_tbl = tribble(
~Nombre,~Extensión,~Tipo,
" ESRI Shapefile",".shp (archivo principal)","Vector",
" GeoJSON",".geojson","Vector",
" KML",".kml","Vector",
" GPX",".gpx","Vector",
" GeoTIFF",".tif/.tiff","Raster",
" Arc ASCII",".asc","Raster",
" R-raster",".gri,.grd","Raster",
" SQLite/SpatiaLite",".sqlite","Vector y raster",
" ESRI FileGDB",".gdb","Vector y raster",
" GeoPackage",".gpkg","Vector y raster")

kbl(my_tbl) %>%
kable_paper("striped", full_width = F) %>%
row_spec(0, bold = T, color = "white", background = "#00008B")
```

Nota: Además del archivo **.shp** (que almacena la geometría del objeto), el ESRI Shapefile debe contener un archivo **.shx** (almacena el índice de la geometría), un archivo **.dbf** (dataframe con los atributos) y un archivo **.prj** (contiene información del CRS).

<!--------------------------------------------------->
<!--- Sistemas de Referencia de Coordenadas (CRS) --->
<!--------------------------------------------------->
## **[2.] Sistemas de Referencia de Coordenadas - CRS**

Todo objeto espacial está asociado a un CRS (Coordinate Reference Systems). El CRS proporciona una referencia espacial estandarizada de un objeto. El CRS puedes ser **Sistema de Coordenadas Geográficas** o un **Sistema de Coordenadas Proyectadas**.

#### **2.1. Sistema de Coordenadas Geográficas - SCG**

En este SCG las ubicaciones se miden en unidades angulares desde el centro de la tierra en relación con dos planos (uno definido en el ecuador y otro definido en el primer meridiano). En este sentido una ubicación se define como la combinación entre un valor de latitud (-90:90) y un valor de longitud (-180:180).

#### **2.2. Sistema de Coordenadas Proyectadas - SCP**

Es un sistema de referencia de coordenadas bidimensional, se define normalmente mediante dos ejes. Ubicados en ángulo recto uno respecto al otro, formando el denominado plano XY (como en un plano cartesiano). Existen por lo menos 3 familias de Sistemas de Coordenadas Proyectadas, Plana (**a**),  Cónica (**b**) o Cilíndrica (**c**). 

![](pics/projection_families.png){width=400}

Tomado de: [https://docs.qgis.org](https://docs.qgis.org/2.8/en/docs/gentle_gis_introduction/coordinate_reference_systems.html)

Por ejemplo, los CRS geográficos y los CRS proyectados están expresados en unidades diferentes. El mapa de la izquierda tiene un CRS que está representado en grados decimales, mientras que la unidad de medida del mapa de la derecha es metros.

![](pics/geographic_projected.png){width=600}

Ver código de R [aquí]()

Sim embargo, dentro de los CRS geográficos/proyectadas pueden existir puntos de origen diferentes. El mapa de la derecha usa un CRS con [EPSG](https://epsg.io) **NAD83** y tiene las unidades de medida en metros, el de la derecha también tiene unidades de medidas de metros, pero usa una CRS Azimuthal que está centrada en Tegucigalpa (coordenadas `lon_0=-87` y `lat_0=14`):

![](pics/origen.png){width=600}

Ver código de R [aquí]()

#### **2.3. Código EPSG**

Todas las CRS cuentan con un código de la European Petroleum Survey Group (EPSG), el cual almacena los parámetros geodésicos con códigos estándar. Puede encontrar otras referencias de EPSG [aquí](https://epsg.io)


<!------------------>
<!--- R-espacial --->
<!------------------>
## **[3.] R-espacial**

[Aquí](https://github.com/r-spatial) puede acceder a los repositorios de GitHub con las librerías de [r-spatial](https://github.com/r-spatial).

<!---------------->
#### **3.1. Popularidad de R-espacial**

![](pics/download_packages.png){width=450}

Ver código de R [aquí]()

<!---------------->
#### **3.2. Librería sf**

Fue escrita por [Edzer Pebesma](https://github.com/edzer) y [Roger Bivand](https://github.com/rsbivand) quienes también la librería `sp` (la versión anterior de `sf`).  

##### **¿Por qué cambiar a `sf` si `sp` ya ha sido probada y probada? **

• Lectura y escritura rápida de datos.

• Rendimiento de trazado mejorado.

• Los objetos sf pueden tratarse como dataframes en la mayoría de las operaciones.

• Las funciones de sf se pueden combinar con el operador %>% y trabaja bastante bien con las funciones de la librería `tidyverse`.

• Los nombres de las funciones sf son relativamente consistentes e intuitivos (todos comienzan con st_).

<!---------------->
##### **Documentación:**

```{r,eval=T,echo=T}
vignette(package = "sf") # Ver viñetas disponibles
```
```{r,eval=F,echo=T}
Vignettes in package ‘sf’:

sf1                      1. Simple Features for R (source, html)
sf2                      2. Reading, Writing and Converting Simple
                         Features (source, html)
sf3                      3. Manipulating Simple Feature Geometries
                         (source, html)
sf4                      4. Manipulating Simple Features (source, html)
sf5                      5. Plotting Simple Features (source, html)
sf6                      6. Miscellaneous (source, html)
sf7                      7. Spherical geometry in sf using s2geometry
                         (source, html)
```

<!---------------->
#### **3.3. ¿Qué es un simple feature?**

Un simple feature es cualquier objeto en el mundo real, como una calle o un edificio. Un objeto `sf` posee una geometría (describe lugar de la Tierra en el que se encuentra) y unos atributos (describe otras propiedades del objeto). La geometría de un árbol puede ser el un círculo con el diámetro de su copa o un punto que indica su centro. Las propiedades pueden incluir su altura, color, diámetro, etc.

<div><img src="https://docs.qgis.org/2.14/es/_images/feature_at_glance.png" height=380></div>
Tomado de: [https://docs.qgis.org](https://docs.qgis.org)   

<!---------------->
##### **Tipos de geometrías para `sf`**

Un objeto `sf`  puede almacenar por lo menos seis de los siguientes tipos de datos vectoriales: 

![](pics/type_geometry.png){width=600}

<!---------------->
##### **Objeto sf en R**

Por ejemplo, si usted tiene un objeto de clase `sf` al que le asignó el nombre de `spatial_objetc`. Puede inspeccionar la clase del objeto así:

```{r,eval=F}
class(spatial_objetc)
"sf"         "data.frame"
```

Y al imprimirlo sobre la consola puede observar que este objeto contiene atributos (columnas `DPTO_CCDGO`,`MPIO_CCDGO`,`CPOB_CCDGO`,`NANG_RTCN` y `CSIMBOL`) e información sobre la geometría:

![](pics/sf_console.png){width=600}

